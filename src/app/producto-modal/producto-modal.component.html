<ion-header>
  <ion-toolbar>
    <ion-title>{{ producto.id ? 'Editar Producto' : 'Nuevo Producto' }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismiss()">Cerrar</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Sección de Código de Barras -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Código de Seguimiento</ion-card-title>
    </ion-card-header>

    <ion-card-content>
      <!-- Botón para escanear código de barras -->
      <ion-item>
        <ion-button expand="full" (click)="scanBarcode()">Escanear Código de Barras</ion-button>
      </ion-item>

      <!-- Mostrar código de barras escaneado -->
      <div *ngIf="producto.trackingCode">
        <p>Código de Barras: {{ producto.trackingCode }}</p>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Sección de Imagen -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Imagen del producto</ion-card-title>
    </ion-card-header>

    <ion-card-content>
      <!-- Botón para tomar foto -->
      <ion-item>
        <ion-button expand="full" (click)="captureImage()">Tomar Foto o Subir Imagen</ion-button>
      </ion-item>

      <!-- Botón para subir foto -->
      <ion-item>
        <input type="file" id="fileInput" accept="image/*" (change)="handleFileInput($event)" style="display: none;" />
      </ion-item>

      <!-- Mostrar imagen capturada o subida -->
      <div *ngIf="producto.image" class="image-container">
        <img [src]="producto.image" alt="Imagen del producto" />
      </div>
    </ion-card-content>
  </ion-card>


  <!-- Nombre del producto -->
  <ion-item>
    <ion-label position="stacked">Nombre del Producto</ion-label>
    <ion-input [(ngModel)]="producto.name"></ion-input>
  </ion-item>

  <!-- Descripción del producto -->
  <ion-item>
    <ion-label position="stacked">Descripción</ion-label>
    <ion-input [(ngModel)]="producto.description"></ion-input>
  </ion-item>

  <!-- Precio del producto -->
  <ion-item>
    <ion-label position="stacked">Precio</ion-label>
    <ion-input [(ngModel)]="producto.price" type="number" min="0"></ion-input>
  </ion-item>

  <!-- Categoría del producto -->
  <ion-item>
    <ion-label position="stacked">Categoría</ion-label>
    <ion-input [(ngModel)]="producto.category"></ion-input>
  </ion-item>

  <!-- Mensaje de error si hay campos vacíos o datos incorrectos -->
  <div *ngIf="errorMessage" style="color: red; margin-top: 10px;">
    {{ errorMessage }}
  </div>

  <!-- Botón de acción según si estamos agregando o editando -->
  <ion-button expand="block" color="primary" (click)="save()">
    {{ producto.id ? 'Guardar Cambios' : 'Agregar Producto' }}
  </ion-button>

  <!-- Botón eliminar solo si el producto ya existe -->
  <ion-button *ngIf="producto.id" expand="block" color="danger" (click)="delete()">Eliminar Producto</ion-button>
</ion-content>
